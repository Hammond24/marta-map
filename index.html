<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>BDC - MARTA</title>
    <style>
    #map {
      height: 500px;
      width: 100%;
    }
  </style>
</head>
<body>
  <img src="marta.png" alt="MARTA Logo" height="100" width="300">
  <div id="map"></div>
  <script>
    function initMap() {
      var georgiaTech = {lat: 33.7756, lng: -84.3963};
      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 11,
        center: georgiaTech
      });

      var marker = new google.maps.Marker({
        position: georgiaTech,
        map: map
      });

      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          var buses = JSON.parse(this.responseText);

          for(i = 0; i < buses.length; i++) {
            var latitude = parseFloat(buses[i].LATITUDE);
            var longitude = parseFloat(buses[i].LONGITUDE);

            var marker1 = new google.maps.Marker({
              position: {lat: latitude, lng: longitude},
              map: map
            });

            var message = '<div><strong>' + buses[i].TIMEPOINT
              + '</strong><br>Route ' + buses[i].ROUTE + '<br>' + '(' + latitude
              + ' , ' + longitude + ')' + '</div>';

            attachInfo(marker1, message);
          }
        }
        };
        xhttp.open("GET", "BusData2.json", true);
        xhttp.send();
      };

      function attachInfo(marker, info) {
            var infowindow = new google.maps.InfoWindow({
              content: info
            });

            marker.addListener('click', function() {
              infowindow.open(marker.get('map'), marker);
            });
          }

    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBpWRyIAxW2rc8HgZssAWARXef2c7qEGgU&callback=initMap">
  </script>
    </body>
  </html>
